<!DOCTYPE HTML>
<html lang="zh">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="PsTools 使用介绍, 宅世界">
    <meta name="description" content="微软的系统工具(sysinternals) 中的 PsTools 介绍">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id=G-8Z4B2QXXNF"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', 'G-8Z4B2QXXNF');
</script>


    <title>PsTools 使用介绍 | 宅世界</title>
    <link rel="icon" type="image/png" href="../../../../favicon.png">

    <link rel="stylesheet" type="text/css" href="../../../../libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="../../../../libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="../../../../libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="../../../../libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="../../../../libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="../../../../css/matery.css">
    <link rel="stylesheet" type="text/css" href="../../../../css/my.css">

    <script src="../../../../libs/jquery/jquery-3.6.0.min.js"></script>

<meta name="generator" content="Hexo 5.4.0"></head>



   <style>
    body{
       background-image: url(/medias/1.png);
       background-repeat:no-repeat;
       background-size: 100% 100%;
       background-attachment:fixed;
    }
</style>



<body>
    <header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="../../../../index.html" class="waves-effect waves-light">
                    
                    <img src="../../../../medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">宅世界</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="../../../../index.html" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>Index</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="../../../../tags" class="waves-effect waves-light">
      
      <i class="fas fa-tags" style="zoom: 0.6;"></i>
      
      <span>Tags</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="../../../../archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>Archives</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="../../../../Other/index.html" class="waves-effect waves-light">
      
      <i class="fas fa-vial" style="zoom: 0.6;"></i>
      
      <span>Lab</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="../../../../https:/sekai.bingfengs.xyz:8443" class="waves-effect waves-light">
      
      <i class="fas fa-globe" style="zoom: 0.6;"></i>
      
      <span>Sekai</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="Search" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="../../../../medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">宅世界</div>
        <div class="logo-desc">
            
            Never really desperate, only the lost of the soul.
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="../../../../index.html" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			Index
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="../../../../tags" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-tags"></i>
			
			Tags
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="../../../../archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			Archives
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="../../../../Other/index.html" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-vial"></i>
			
			Lab
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="../../../../https:/sekai.bingfengs.xyz:8443" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-globe"></i>
			
			Sekai
		</a>
          
        </li>
        
        
    </ul>
</div>


        </div>

        
    </nav>

</header>

    



<div class="bg-cover pd-header post-cover" style="background-image: url('../../../../medias/featureimages/16.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">PsTools 使用介绍</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="../../../../libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="../../../../tags/Windows/">
                                <span class="chip bg-color">Windows</span>
                            </a>
                        
                            <a href="../../../../tags/%E7%AC%94%E8%AE%B0/">
                                <span class="chip bg-color">笔记</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>Publish Date:&nbsp;&nbsp;
                    2019-10-15
                </div>
                

                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-check fa-fw"></i>Update Date:&nbsp;&nbsp;
                    2023-04-09
                </div>
                

                
                <div class="info-break-policy">
                    <i class="far fa-file-word fa-fw"></i>Word Count:&nbsp;&nbsp;
                    4.6k
                </div>
                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="../../../../libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <p><a target="_blank" rel="noopener" href="https://docs.microsoft.com/en-us/sysinternals/">下载地址</a></p>
<p>Pstools 只是 Sysinternals 这个工具集中的一小部分。其他可以参考 <code>Windows Sysinternals 实战指南</code> 这本书。</p>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>PSTools 本身就有十来个<code>命令行</code>小工具</p>
<ul>
<li>PsExec – 在远程计算机执行命令</li>
<li>PsFile – 查看打开的网络文件</li>
<li>PsGetSid – 获取 Machine SID</li>
<li>PsInfo – 查看简要系统信息</li>
<li>PsKill – 按进程名或PID杀掉进程</li>
<li>PsList – 列出进程信息</li>
<li>PsLoggedOn – 显示已登的会话</li>
<li>PsLogList – 命令行获取 event log</li>
<li>PsPasswd – 更改用户密码</li>
<li>PsPing – 简单的tcp/udp连接测试工具</li>
<li>PsService – Windows 服务管理命令</li>
<li>PsShutdown – 关机、注销命令</li>
<li>PsSuspend – 暂停或恢复某个进程</li>
</ul>
<h2 id="通用功能"><a href="#通用功能" class="headerlink" title="通用功能"></a>通用功能</h2><p>以上所有命令都可以直接在本地计算机上使用，不过 PsTools 设计出来就是为了方便对远程 PC 进行管理的。</p>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><p>PsTools 所有工具连接远程计算机都可以使用同一个通用语法，例如：</p>
<p><code>psinfo \\pc1，pc2，pc3</code></p>
<p>可以指定一个文件，里面包含多台远程计算机：</p>
<p><code>psinfo @computers.txt</code></p>
<p>双斜杠后面可以直接跟计算机名（可以解析 netbios）、IP 地址或 FQDN，也可以在命令后跟多台计算机以实现批量。</p>
<p>如果你不是以域管理员等有权限的用户来执行命令、没有域环境或者需要手动指定有权限的远程用户，可用 <code>-u</code> 参数指定用户，<code>-p</code> 参数指定密码。</p>
<p>如果是域环境，需要将用户写为 <code>DOMAIN\user</code> 样式：</p>
<p><code>psinfo \\computername –u user –p Password</code></p>
<p>如果用户名和密码包含空格，需要双引号：</p>
<p><code>psinfo \\server1 -u &quot;mydomain\admin account&quot; -p &quot;password with spaces&quot;</code></p>
<p>如果忽略 <code>-p</code>，工具会要求我们输入密码。同 Linux 一样，输入密码没有字符位显示。</p>
<p><strong>需要注意，就算我们指定了凭据，PsTools 也会首先尝试使用当前进程的身份进行验证，只在第一次尝试失败后才会使用指定的备用凭据。</strong></p>
<h3 id="连接排错"><a href="#连接排错" class="headerlink" title="连接排错"></a>连接排错</h3><ul>
<li>一些工具要求启用管理用 Admin$ 共享。这就要求启用文件和打印共享（本地的 Workstation 服务和目标系统的 Server 服务），并且防火墙没有阻止文件和打印机共享所需的端口，此外必须禁用 “简单文件共享”。</li>
</ul>
<ul>
<li><p>如果你发现你的命令输入没有错误，但是总是提示 “The network path was not found.”，那你需要执行下面的命令行之后，即可正常执行 sysinternals 的工具。这是因为一些工具要求目标系统的 Remote Registry 服务正常运行。但是在新版 Windows 中，该服务默认并未配置为自动启动。</p>
<ul>
<li><p>To start the Remote Registry service via a command line:</p>
<p><code>sc start RemoteRegistry</code></p>
</li>
<li><p>To have it start automatically every time:</p>
<p><code>sc config RemoteRegistry start=auto</code></p>
</li>
<li><p>(重要)To do this to a remote machine named Desktop1:</p>
<p><code>sc \\Desktop1 config RemoteRegistry start=auto</code></p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>大部分工具需要具备管理权利。在 Windows Vista 和用户账户控制机制出现前，管理员权利的获取相当简单。如果账户隶属于 Administrators 组，那么该账户运行的所有程序都将具备完整的管理权利。只要使用目标计算机上 Administrators 组的账户成功通过身份验证即可获得远程计算机的完整控制权。</p>
<p>Windows Vista 中引入了用户账户控制，该机制（以及其他多项技术）将同一个用户账户同时视作管理账户和标准用户账户的概念是一种创新。此类账户有时候也被叫做 <code>受保护的管理员</code>。该措施的目的在于用户运行的程序将使用标准用户特权运行，如果希望以完整的管理权限运行程序，则用户必须明确批准进行提升。<strong>以用户身份运行的程序不能以编程化的方式批准提升而绕过用户的介入。</strong></p>
<p>Windows Vista 还禁止了通过网络环回（Network loopback）进行自动提升的做法。正如微软知识库（KB）文章 951016 所述，<strong>如果使用隶属于 Administrators 组的本地账户建立了到远程计算机的网络连接，则该连接只具备标准用户特权。由于这并非是交互式登录，因此无法提升为完整管理员权限。域账户不受该机制限制</strong>。</p>
<p>这意味着 PsTools 工具可以使用本地账户非常完美地运行 Windows XP 和 Windows Server 2003 的远程计算机，但无法直接用于管理 Windows Vista 及更新版系统。如果无法使用域账户，可以参阅 KB951016 以了解如何设置 <code>LocalAccountTokenFilterPolicy</code> 选项以撤销关于本地账户的这种限制。这种现象体现到操作，就是你提供了正确的管理账号密码，PsTools 还是会提示 <code>Access is denied</code>。解决方法如下：</p>
<p><a target="_blank" rel="noopener" href="https://learn.microsoft.com/en-us/troubleshoot/windows-server/windows-security/user-account-control-and-remote-restriction">Microsoft 官方教程</a>，请参照 <code>How to disable UAC remote restrictions</code> 这一部分。</p>
<p><a target="_blank" rel="noopener" href="https://www.brandonmartinez.com/2013/04/24/resolve-access-is-denied-using-psexec-with-a-local-admin-account/">其他教程</a>，同上面微软官方的一样。</p>
</li>
</ul>
<h2 id="PsExec"><a href="#PsExec" class="headerlink" title="PsExec"></a>PsExec</h2><p>PsExec 是 PsTools 工具系列中最为常用的一个命令行工具，它可以让我们在本地或远程计算机上「运行」任何东西，包括更改注册表、执行脚本或应用程序等。</p>
<h3 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h3><ul>
<li><p>命令说明:</p>
<ul>
<li><p>基本：<br><code>psexec \\计算机名 &lt;选项&gt; apptorun.exe &lt;参数&gt;</code></p>
<p>例如你想查看某个远程计算机的 TCP/IP 配置，可以使用如下命令：<br><code>psexec \\计算机名 -u User -p Password ipconfig /all</code></p>
<p>如果命令行的 “程序” 部分包含空格，则必须将程序路径包裹在引号中。</p>
<p>如果远程命令行部分包含特殊字符，如管道或重定向字符，则可以使用命令外壳的转义字符，例如 Cmd.exe 的 <code>^</code> 或 PowerShell 的反引号 (`) 以防止这些内容被本地命令外壳是做特殊字符。</p>
</li>
<li><p>文件输出：<br>在 server1 运行 ipconfig /all，并将输出重定向至 server1 上的 c:\ipconfig.out:<br><code>psexec \\server1 cmd.exe /c ipconfig /all ^&gt; c:\ipconfig.out</code></p>
<p>如果不使用转义字符 <code>^</code>，PsExec 命令的输出将被写入本地计算机，而不是远程计算机。</p>
<p>如果你将命令输出重定向到一个文件中，可以使用常见的 command.exe &gt; output.txt 方式，这种方式对 PsExec 命令同样适用，例如我们可以使用类似如下命令将 netstat -an 的输出保存到本地文本文件中：<br><code>psexec \\计算机名 netstat -an &gt; C:\netstat.txt</code></p>
</li>
<li><p>cmd<br>  一些常用命令，如 <code>dir</code>、<code>mklink</code>、<code>copy</code> 并非单独的可执行程序，而是内建在 cmd 中。若要运行内建命令，可使用 <code>cmd</code> 的 <code>/c</code> 选项在 cmd.exe 运行：<br>  <code>psexec \\server1 cmd.exe /c ver</code></p>
</li>
<li><p><code>-c</code> 选项<br>如果我们要在远程系统运行的程序并未安装在目标系统中，PsExec 可将其从本地文件系统复制到远程计算机的 <code>System32</code> 目录，从该位置运行，并在运行结束后将其删除。该选项只能复制单个文件，无法复制依赖的 DLL 或其他文件。</p>
<p>如果单独使用 <code>-c</code>，并且目标位置已经存在该文件，PsExec 将不执行文件复制操作。配合使用 <code>-f</code> 选项可强制复制文件。<br><code>psexec \\计算机名 -c autorunsc.exe –accepteula</code></p>
</li>
<li><p><code>-s</code> 选项<br>该选项可以用 System 账户运行目标应用程序。如果<code>同时未使用</code> <code>-i</code> 交互式选线，**进程将与其他以 System 身份执行的 Windows 服务运行在同一个非交互式环境（会话 0）中。这种执行模式的优势之一在于就算交互式用户已注销，进程依然可以顺利运行。</p>
</li>
<li><p><code>-i</code> 选项<br>可以用于在目标系统上以交换式方式运行目标进程（有 GUI）。目标系统必须已经登录相对应的用户账号！<br><code>psexec -s -i regedit.exe</code><br><code>psexec -i \\REMOTECOMPUTER notepad</code></p>
<p>Be sure to also use the <code>-d</code> switch to disconnect when the interactive window is brought up though. By default， PsExec will wait for the process it executed to complete. If the remote process (Notepad in this case) is kept running， PsExec will never return control.</p>
</li>
<li><p><code>-h</code> 选项<br>在 Windows Vista 和更新版的系统中，“交互” 式登录（如明确提供凭据后进行的登录）会受限于令牌筛选（Token filtering）控制：管理员组会被禁用，管理特权会被移除。在明确提供凭据的情况下，使用 <code>-h</code> 选项可在远程系统上以用户账户的完整管理令牌启动目标进程。如果目标系统是本地计算机，则只有在用提升模式运行 PsExec 的情况下才可以通过 -h 用提升后的令牌运行目标进程。</p>
<p>下图是在非域的环境下，使用管理员账号，有无 -h 的区别：</p>
<p><img src="7.png"></p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>本地用法</p>
<p>在本地计算机上启动进程也可以使用 -u 和 -p 选项，其效果同 RunAs.exe 类似。同样与 RunAs 类似的是，由于 UAC 的存在，Windows Vista 或更新版的系统上运行的目标进程无法获得完整管理权利，哪怕所用的用户账户是 Administrators 组成员。</p>
<p>对于具体用法，请参考上面的 [连接排错] 部分</p>
</li>
<li><p>跳过第一次打开软件的条款同意声明</p>
<p><code>psexec /accepteula</code></p>
</li>
<li><p>如果不指定密码，命令行里面会让你输入密码</p>
<p><code>D:\runsoftware\SysinternalsSuite\PsExec.exe \\192.168.1.102 -u ieuser netstat -na</code></p>
<p><img src="6.png"></p>
</li>
</ul>
<ul>
<li><p>像 linux 的 ssh 一样使用，远程 Windows</p>
<p><code>psexec \\wss11 -u 666 -p general cmd</code></p>
</li>
</ul>
<ul>
<li><strong>Do NOT use Ctrl-C to close out of an interactive cmd session. Always use <code>exit</code>. If you use Ctrl-C， the psexec session will remain running on the remote computer.</strong></li>
</ul>
<h3 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h3><ul>
<li><p>psexec 给远程电脑安装软件<br><code>psexec \\192.168.2.223  -u administrator  -p &quot;&quot; -h -s -c D:\download\Apache_OpenOffice_4.1.7_Win_x86_install_en-US.exe  /S /v /qb</code></p>
<ul>
<li><code>-p &quot;&quot;</code>：表示密码为空</li>
<li><code>-c</code>：表示复制文件到远程电脑</li>
<li><code>D:\download\Apache_OpenOffice_4.1.7_Win_x86_install_en-US.exe</code>：这个文件是位于本地电脑的</li>
<li><code>/S /v /qb</code>：表示OpenOffice静默安装参数</li>
</ul>
</li>
<li><p>打开远程机器的IE浏览器</p>
<p><code>PsExec.exe \\192.168.1.102 -u ieuser -p general -d -i  &quot;C:\Program Files (x86)\Internet Explorer\iexplore.exe&quot;</code></p>
<ul>
<li><p><code>-d</code>：表示不等待远端机器执行的结果，命令发送后就立即返回</p>
</li>
<li><p><code>-i</code>：在远程端口开启互动界面(GUI).没有这个参数，你在远程机器上是看不到IE浏览器的，只有后台有一个进程而已</p>
</li>
<li><p>后面的IE路径，因为有空格，需要加上双引号</p>
<p>下图为有无参数-d的区别(两个命令都成功打开了IE)<br><img src="1.png"></p>
</li>
</ul>
</li>
<li><p>notepad 打开文本</p>
<p>如下两种写法都是可以的:</p>
<p><code>D:\runsoftware\SysinternalsSuite\PsExec.exe \\192.168.1.102 -u ieuser -p general -d -w C:\runsoftwares -i notepad psexecTest.bat</code></p>
<p><code>D:\runsoftware\SysinternalsSuite\PsExec.exe \\192.168.1.102 -u ieuser -p general -d -i notepad  C:\runsoftwares\psexecTest.vbs</code></p>
<p><img src="2.png"></p>
</li>
</ul>
<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><p>运行远程 PC 上的 vbs 脚本报错</p>
<p>运行 bat 没有问题，但是 vbs 会出现 <code>The system cannot find the file specified.</code> 报错。在不同的电脑测试均出现此问题。 目前找不到原因</p>
<p><img src="3.png"></p>
<p>目前找到该问题的解法，感谢大佬的指路。据说是PATH里找不到执行的文件，在命令里加上 <code>wscript</code> 就行：</p>
<p><code>D:\runsoftware\SysinternalsSuite\PsExec.exe \\192.168.1.102 -u ieuser -p general wscript  C:\Users\bingfeng\Documents\script\vbs\psexecTest.vbs</code></p>
<h3 id="参数说明"><a href="#参数说明" class="headerlink" title="参数说明"></a>参数说明</h3><ul>
<li><p>-a<br>Separate processors on which the application can run with commas where 1 is the lowest numbered CPU. For example， to run the application on CPU 2 and CPU 4， enter: “-a 2，4”</p>
</li>
<li><p>-c<br>Copy the specified program to the remote system for execution. If you omit this option the application must be in the system path on the remote system.</p>
</li>
<li><p>-d<br>Don’t wait for process to terminate (non-interactive).</p>
</li>
<li><p>-e<br>Does not load the specified account’s profile.</p>
</li>
<li><p>-f<br>Copy the specified program even if the file already exists on the remote system.</p>
</li>
<li><p>-i<br>Run the program so that it interacts with the desktop of the specified session on the remote system. If no session is specified the process runs in the console session. Some have reported best results always using the -s switch with -i due to windows being unintelligible.</p>
</li>
<li><p>-h<br>If the target system is Vista or higher， has the proc</p>
</li>
<li><p>-l<br>Run process as limited user (strips the Administrators group and allows only privileges assigned to the Users group). On Windows Vista the process runs with Low Integrity.</p>
</li>
<li><p>-n<br>Specifies timeout in seconds connecting to remote computers.</p>
</li>
<li><p>-p<br>Specifies optional password for user name. If you omit this you will be prompted to enter a hidden password.</p>
</li>
<li><p>-r<br>Specifies the name of the remote service to create or interact. with.</p>
</li>
<li><p>-s<br>Run the remote process in the System account.</p>
</li>
<li><p>-u<br>Specifies optional user name for login to computer.</p>
</li>
<li><p>-v<br>Copy the specified file only if it has a higher version number or is newer on than the one on the remote system.</p>
</li>
<li><p>-w<br>设置进程的工作目录（相对于远程计算机）</p>
</li>
<li><p>-x<br>Display the UI on the Winlogon secure desktop (local system only).</p>
</li>
<li><p>-arm     Specifies the remote computer is of ARM architecture.</p>
</li>
<li><p>-priority<br>Specifies -low， -belownormal， -abovenormal， -high or  -realtime</p>
</li>
<li><p>-realtime<br>run the process at a different priority. Use</p>
</li>
<li><p>-background<br>run at low memory and I/O priority on Vista.</p>
</li>
<li><p>computer<br>Direct PsExec to run the application on the computer or computers specified. If you omit the computer name PsExec runs the application on the local system， and if you specify a wildcard (*)， PsExec runs</p>
</li>
<li><p>@file<br>PsExec will execute the command on each of the computers listed in the file.</p>
</li>
<li><p>-accepteula<br>This flag suppresses the display of the license dialog.</p>
</li>
<li><p>-nobanner<br>Do not display the startup banner and copyright message.</p>
</li>
</ul>
<h3 id="psexec-工作原理"><a href="#psexec-工作原理" class="headerlink" title="psexec 工作原理"></a>psexec 工作原理</h3><p>PsExec goes through a few steps to execute programs on remote computers.</p>
<ul>
<li>Create a PSEXESVC.exe file in C:\Windows.</li>
<li>Create and start a Windows service on the remote computer called PsExec.</li>
<li>Execute the program under a parent process of psexesvc.exe.</li>
<li>When complete， the PsExec Windows service will be stopped and removed.</li>
</ul>
<p>When the process doesn’t work 100% correctly you may have to manually remove the service using the sc command.</p>
<p><a target="_blank" rel="noopener" href="https://blog.51cto.com/leomars/1900528">https://blog.51cto.com/leomars/1900528</a></p>
<h2 id="PsFile"><a href="#PsFile" class="headerlink" title="PsFile"></a>PsFile</h2><ul>
<li>psfile 命令可以显示本地或远程 PC 中通过网络打开的文件，其类似于命令行中的 net file 命令，及 NetworkOpenedFiles 图形界面工具<pre class="line-numbers language-none"><code class="language-none">psfile \\计算机名<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<ul>
<li>如果你想中断某个共享的访问连接，可以使用 -c 参数：<pre class="line-numbers language-none"><code class="language-none">psfile \\计算机名 &lt;路径&gt; –c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<h2 id="PsInfo"><a href="#PsInfo" class="headerlink" title="PsInfo"></a>PsInfo</h2><p>PsInfo 主要用于显示 Windows 操作系统版本、系统运行时长及个别硬件的简单信息，如果你想获取更详尽的信息，可以使用 -d（磁盘信息）、-h（补丁信息）、-s（已知应用程序版本列表）参数，这样一来就比较像 Windows 内置的 systeminfo 命令行了。</p>
<pre class="line-numbers language-none"><code class="language-none">psinfo -d -h -s<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<h2 id="PsKill"><a href="#PsKill" class="headerlink" title="PsKill"></a>PsKill</h2><p>PsKill 看名称就不难猜，它可按进程名或 PID 结束进程，使用 -t 参数可以杀掉整个进程树。</p>
<pre class="line-numbers language-none"><code class="language-none">pskill \\计算机名 <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h2 id="PsList"><a href="#PsList" class="headerlink" title="PsList"></a>PsList</h2><p>它可以通过列表方式看到进程的几乎所有信息，包括线程数</p>
<h2 id="PsLoggedOn"><a href="#PsLoggedOn" class="headerlink" title="PsLoggedOn"></a>PsLoggedOn</h2><p>PsLoggedOn 命令主要用于查看本地或远程 PC 上当前登录的用户信息，对于系统管理员来说非常实用。</p>
<h2 id="PsPing"><a href="#PsPing" class="headerlink" title="PsPing"></a>PsPing</h2><p>PsPing 是一个可对指定端口进行 TCP 或 UDP 连接测试的工具</p>
<h2 id="PsPasswd"><a href="#PsPasswd" class="headerlink" title="PsPasswd"></a>PsPasswd</h2><p>PsPasswd 用于快速更改本地或远程 PC 的用户密码</p>
<p>该命令相较 net user 的好处在于可以一次性批量修改多台计算机的密码，对于域管理员批量重置某些本地账户密码时非常有用</p>
<pre class="line-numbers language-none"><code class="language-none">pspasswd \\计算机名 -u User -p Password &lt;账户名称&gt; &lt;新密码&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<h2 id="PsSuspend"><a href="#PsSuspend" class="headerlink" title="PsSuspend"></a>PsSuspend</h2><p>该命令行工具与 PsKill 比较类似但不是杀掉进程，它主要用于暂停某个进程的工作</p>
<p>要将已暂停的进程恢复到工作状态，只需加上 -r 参数即可</p>
<pre class="line-numbers language-none"><code class="language-none">pssuspend \\计算机名 &lt;PID或进程名&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<h2 id="PsService"><a href="#PsService" class="headerlink" title="PsService"></a>PsService</h2><p>PsService 命令行工具可操作 Windows 中的各种服务，其语法如下</p>
<pre class="line-numbers language-none"><code class="language-none">psservice \\计算机名 &lt;操作&gt; &lt;服务名&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>用的操作有start（启动）、stop（停止）、pause（暂停）、restart（重启），要查看详细参数可以使用 PsService /?</p>
<h1 id="TCPView"><a href="#TCPView" class="headerlink" title="TCPView"></a>TCPView</h1><p>TCPView 是用于查看当前 Windows 应用程序和服务连网状态的绝佳工具，通过它我们可以在图形界面中查看到类似使用 netstat 命令输出的大部分信息。</p>
<p>与其它 Sysinternals 工具的颜色标识类似，绿色条目表示刚建立连接、红色表示连接正在关闭，而黄色则表示更改了连接指向</p>
<h1 id="RamMap"><a href="#RamMap" class="headerlink" title="RamMap"></a>RamMap</h1><p>RamMap 工具主要用于分析物理内存的使用情况，它以可视化的图形界面进行输出显示。在 RamMap 界面中，你可以查看到非常详细的内存用量，例如：空闲内存、页面缓冲池、非页面缓冲池、已提交和已缓存等条目的详细情况，比任务管理器中的内存显示强大多了。</p>
<h1 id="Autologon"><a href="#Autologon" class="headerlink" title="Autologon"></a>Autologon</h1><p>Autologon 可以快速实现Windows自动登录（有登录密码情况下）<br>在打开之后，只需输入要用于自动登录的账户和密码即可。</p>
<p>其它自动登录的方法</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="http://www.sysgeek.cn/auto-login-windows-10/">http://www.sysgeek.cn/auto-login-windows-10/</a></p>
</blockquote>
<h1 id="AccessEnum"><a href="#AccessEnum" class="headerlink" title="AccessEnum"></a>AccessEnum</h1><p>AccessEnum 是我在做文件夹权限排错时最常用的一个工具，在我们对某个文件夹进行过复杂的权限配置后，AccessEnum 工具可以非常容易帮助我们理清文件夹或注册表的最终访问控制列表。</p>
<h1 id="SigCheck"><a href="#SigCheck" class="headerlink" title="SigCheck"></a>SigCheck</h1><p>SigCheck 命令行工具最常用的是 -u 参数，它只报告有问题的文件；-e 参数表示只对可执行文件进行检查。所以，我们可以使用如下命令对 C:\Windows\System32 （或某个其它）文件夹进行快速检查：</p>
<pre class="line-numbers language-none"><code class="language-none">sigcheck -e -u C:\Windows\System32<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>在发现异常文件时，可以使用 -v 参数开启 VirusTotal 校验</p>
<pre class="line-numbers language-none"><code class="language-none">sigcheck -v -vt &lt;文件名&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h1 id="Contig"><a href="#Contig" class="headerlink" title="Contig"></a>Contig</h1><pre class="line-numbers language-none"><code class="language-none">contig &lt;文件名&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如果你要分析一个文件的碎片而不实际整理，可以使用 -a 参数</p>
<h1 id="du"><a href="#du" class="headerlink" title="du"></a>du</h1><p>而 du 是 Sysinternals 套件中的命令行磁盘和文件夹大小查看工具。du 命令行工具的存在主要是因为其显示更为准确，而且在计算空间时不会计数符号链接文件</p>
<p>其中 -n 参数在统计大小时不递归在子文件夹，-v 参数将详细列表显示子文件夹大小（KB），-l 参数可以单独控制子文件夹递归层级（默认为 1）</p>
<h1 id="Disk2vhd"><a href="#Disk2vhd" class="headerlink" title="Disk2vhd"></a>Disk2vhd</h1><p>Disk2vhd 小工具可将正在运行计算机的磁盘克隆成 VHD 虚拟磁盘文件，因此它也成为不少虚拟化项目中的 P2V 转换工具</p>
<h1 id="Autoruns"><a href="#Autoruns" class="headerlink" title="Autoruns"></a>Autoruns</h1><ul>
<li>粉红色：表示该条目对应的应用没有数字签名、签名不匹配或没有发行商信息</li>
<li>黄色：表示该启动条目对应的文件已经不存在了</li>
<li>绿色：该功能不太常用，简单来说就是我们可以在使用 File — Save 对启动项目进行导出成 .arn 格式进行存储，之后有可能在 Autoruns 里面对启动条目进行了配置，然后再在 File — Compare 里面载入之前导出的 .arn 文件即可对不同时间和状态下 Windows 启动条目进行对比，对比出来的差异将以绿色高亮进行显示。</li>
</ul>
<h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.sysgeek.cn/?s=SysInternals%E7%B3%BB%E5%88%97">https://www.sysgeek.cn/?s=SysInternals%E7%B3%BB%E5%88%97</a></p>
</blockquote>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        Author:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="../../../../about" rel="external nofollow noreferrer">ROOT</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        Link:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="https://blog.bingfengs.xyz">https://blog.bingfengs.xyz</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        Reprint policy:
                    </i>
                </span>
                <span class="reprint-info">
                    All articles in this blog are used except for special statements
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    reprint policy. If reproduced, please indicate source
                    <a href="../../../../about" target="_blank">ROOT</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>Copied successfully, please follow the reprint policy of this article</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">more</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="../../../../tags/Windows/">
                                    <span class="chip bg-color">Windows</span>
                                </a>
                            
                                <a href="../../../../tags/%E7%AC%94%E8%AE%B0/">
                                    <span class="chip bg-color">笔记</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="../../../../libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="../../../../libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    
        <div class="disqus-card card" data-aos="fade-up">
    <div id="disqus_thread" class="card-content">
        <noscript>Please enable JavaScript to view the
            <a target="_blank" rel="noopener" href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
    </div>
</div>

<script type="text/javascript">
    disqus_config = function () {
        this.page.url = 'https://blog.bingfengs.xyz/2019/10/15/sysinternals-gong-ju-xi-lie/';
        this.page.identifier = '';
        this.page.title = 'PsTools 使用介绍';
    };
    let disqus_shortname = 'bingfeng';

    (function () { // DON'T EDIT BELOW THIS LINE
        let d = document, s = d.createElement('script');
        // 如：s.src = 'https://blinkfox.disqus.com/embed.js';
        s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;Previous</div>
            <div class="card">
                <a href="../pi-chu-li/">
                    <div class="card-image">
                        
                        <img src="../../../../medias/featureimages/24.jpg" class="responsive-img" alt="批处理笔记">
                        
                        <span class="card-title">批处理笔记</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            记录一下批处理的一些知识点,方便后续查看
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2019-10-15
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            ROOT
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="../../../../tags/Windows/">
                        <span class="chip bg-color">Windows</span>
                    </a>
                    
                    <a href="../../../../tags/%E7%BC%96%E7%A8%8B/">
                        <span class="chip bg-color">编程</span>
                    </a>
                    
                    <a href="../../../../tags/%E7%AC%94%E8%AE%B0/">
                        <span class="chip bg-color">笔记</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                Next&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="../../../09/28/ru-he-zheng-que-dui-yong-hu-mi-ma-jin-xing-jia-mi/">
                    <div class="card-image">
                        
                        <img src="../../../../medias/featureimages/22.jpg" class="responsive-img" alt="如何正确对用户密码进行加密">
                        
                        <span class="card-title">如何正确对用户密码进行加密</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2019-09-28
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            ROOT
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="../../../../tags/%E5%AE%89%E5%85%A8/">
                        <span class="chip bg-color">安全</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="../../../../libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="../../../../libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="../../../../libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="../../../../libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card" style="background-color: white;">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;TOC</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src="../../../../libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>

    

</main>




    <footer class="page-footer bg-color">
    

    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2023</span>
            
            |&nbsp;Administrated by&nbsp;
            <a href="../../../../about" target="_blank">ROOT</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;Total visits:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
                <span id="icp"><img src="../../../../medias/icp.png"
                                    style="vertical-align: text-bottom;"/>
                <a href="../../../../https:/sekai.bingfengs.xyz:8443" target="_blank">备案，不存在的！</a>
            </span>
            
            <br>
            <br>
            <span>苔痕上階綠，草色入簾青。談笑有鴻儒，往來無白丁。<br>
                可以調素琴，閱金經。無絲竹之亂耳，無案牘之勞形。</span>
            <br>
            <br>
        </div>
        <div class="col s12 m4 l4 social-link social-statis">














</div>
    </div>
</footer>

<div class="progress-bar"></div>


    <!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;Search</span>
            <input type="search" id="searchInput" name="s" placeholder="Please enter a search keyword"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('../../../../search.xml', 'searchInput', 'searchResult');
});
</script>

    <!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


    <script src="../../../../libs/materialize/materialize.min.js"></script>
    <script src="../../../../libs/masonry/masonry.pkgd.min.js"></script>
    <script src="../../../../libs/aos/aos.js"></script>
    <script src="../../../../libs/scrollprogress/scrollProgress.min.js"></script>
    <script src="../../../../libs/lightGallery/js/lightgallery-all.min.js"></script>
    <script src="../../../../js/matery.js"></script>

    

    

    <!-- 雪花特效 -->
    

    <!-- 鼠标星星特效 -->
     
        <script type="text/javascript">
            // 只在桌面版网页启用特效
            var windowWidth = $(window).width();
            if (windowWidth > 768) {
                document.write('<script type="text/javascript" src="../../../../libs/others/star.js"><\/script>');
            }
        </script>
    

     
        <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
        <script src="../../../../libs/others/TencentCaptcha.js"></script>
        <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button" hidden></button>
    

    <!-- Baidu Analytics -->

    <!-- Baidu Push -->

    
    
    <script async src="../../../../libs/others/busuanzi.pure.mini.js"></script>
    

    

    

    <!--腾讯兔小巢-->
    
    

    

    

    
    <script src="../../../../libs/instantpage/instantpage.js" type="module"></script>
    

</body>

</html>
